---
layout: single
title: SSRF with filter bypass via open redirection vulnerability – PortSwigger Write Up
excerpt: "En este post vamos a estar resolviendo el laboratorio de PortSwigger: “SSRF with filter bypass via open redirection vulnerability."
date: 2022-10-30
classes: wide
#header:
#  teaser: /assets/images/portswigger/stored_xss_into_html_context_with_nothing_encoded/portada.png
#  teaser_home_page: true
categories:
  - Portswigger
tags:
  - SSRF
  - Practitioner
---

En este post vamos a estar resolviendo el laboratorio de PortSwigger: "SSRF with filter bypass via open redirection vulnerability."

## Pasos


<p align="center">
     <img src="/assets/images/portswigger/ssrf_with_filter_bypass_via_open_redirection_vulnerability/1.png" width="1000">
</p><br>

Vamos a ver la web y vamos a ir a ver los detalles de un producto.

<p align="center">
     <img src="/assets/images/portswigger/ssrf_with_filter_bypass_via_open_redirection_vulnerability/2.png" width="1000">
</p><br>

Una vez dentro vamos a `interceptar` la petición con el burpsuite.

<p align="center">
     <img src="/assets/images/portswigger/ssrf_with_filter_bypass_via_open_redirection_vulnerability/3.png" width="1000">
</p><br>

En la URL de la petición vamos a `decodearla`, a con `Ctrl U`.

<p align="center">
     <img src="/assets/images/portswigger/ssrf_with_filter_bypass_via_open_redirection_vulnerability/4.png" width="1000">
</p><br>

<p align="center">
     <img src="/assets/images/portswigger/ssrf_with_filter_bypass_via_open_redirection_vulnerability/5.png" width="1000">
</p><br>

En este caso vamos a volver a la web, donde podemos ver que hay un botón para ver el siguiente producto, con el burpsuite activado vamos interceptar la petición.

<p align="center">
     <img src="/assets/images/portswigger/ssrf_with_filter_bypass_via_open_redirection_vulnerability/6.png" width="1000">
</p><br>

Vamos a copiar la URL de la petición para ver en la URL de la web también se puede hacer

<p align="center">
     <img src="/assets/images/portswigger/ssrf_with_filter_bypass_via_open_redirection_vulnerability/7.png" width="1000">
</p><br>

Si podemos ver en la URL en el path si nos hace un `redirect` es que es vulnerable, en este caso le ponemos la ruta de google y si nos redirecciona.
Ya tenemos una potencial vulnerabilidad, vamos a volver al burpsuite para completar el laboratorio.


<p align="center">
     <img src="/assets/images/portswigger/ssrf_with_filter_bypass_via_open_redirection_vulnerability/8.png" width="1000">
</p><br>


<p align="center">
     <img src="/assets/images/portswigger/ssrf_with_filter_bypass_via_open_redirection_vulnerability/9.png" width="1000">
</p><br>


Volvemos a capturar la petición del `next product` y vamos a usar una IP de la red interna como nos dice en la descripción del laboratorio y escribirla después del path para que nos haga un `redirect`. Bingo, hemos accedido al panel, ya solo nos falta eliminar 
el usuario `Carlos`.

<p align="center">
     <img src="/assets/images/portswigger/ssrf_with_filter_bypass_via_open_redirection_vulnerability/10.png" width="1000">
</p><br>


<p align="center">
     <img src="/assets/images/portswigger/ssrf_with_filter_bypass_via_open_redirection_vulnerability/11.png" width="1000">
</p><br>

Laboratorio realizado.

<p align="center">
     <img src="/assets/images/portswigger/ssrf_with_filter_bypass_via_open_redirection_vulnerability/12.png" width="1000">
</p><br>



¡Un saludo y espero que os sirva de apoyo!
